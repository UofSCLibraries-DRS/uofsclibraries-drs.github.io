
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Machine Learning Tutorial in R: From Data Cleaning to Classification (Using Iris Dataset) &#8212; USC Libraries - DRS Resources for Data Literacy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'src/MachineLearning/RCode/ML_Classification_Tutorial_R';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-light" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>
    <script>document.write(`<img src="../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-dark" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Python/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Python/GettingData.html">Getting Data (APIs, Web Scraping)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DataProcessingBasics/DataCleaning_Basics.html">Data Cleaning Basics</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../Data_Visualization/DataVisualization.html">Data Visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/IntroductionTextAnalysis.html">Introduction to Text Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/AdvancedTextAnalysis.html">Advanced Text Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/MultiLingualNer.html">Named Entity Recognition (NER)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/TextPreprocessing/TextPreprocessingMethods.html">Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../R_Code/Data_Wrangling.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/With_R/GettingStarted.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../PythonCode/Python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="R.html">R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AppDevelopment/AppDevelopment.html">Getting Started</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io/issues/new?title=Issue%20on%20page%20%2Fsrc/MachineLearning/RCode/ML_Classification_Tutorial_R.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/src/MachineLearning/RCode/ML_Classification_Tutorial_R.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Machine Learning Tutorial in R: From Data Cleaning to Classification (Using Iris Dataset)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Machine Learning Tutorial in R: From Data Cleaning to Classification (Using Iris Dataset)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-load-libraries">Step 1: Load Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-load-iris-dataset-a-built-in-dataset-in-r">Step 2: Load Iris Dataset, a built-in dataset in R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-data-cleaning">Step 3: Data Cleaning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-exploratory-data-analysis">Step 4: Exploratory Data Analysis</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-split-the-data">Step 5: Split the Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-feature-scaling">Step 6: Feature Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-train-classifier">Step 7: Train Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-evaluate-model">Step 8: Evaluate Model</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="machine-learning-tutorial-in-r-from-data-cleaning-to-classification-using-iris-dataset">
<h1>Machine Learning Tutorial in R: From Data Cleaning to Classification (Using Iris Dataset)<a class="headerlink" href="#machine-learning-tutorial-in-r-from-data-cleaning-to-classification-using-iris-dataset" title="Link to this heading">#</a></h1>
<p>This notebook demonstrates a complete machine learning workflow in R—from data cleaning to model evaluation—using the Iris dataset. It’s a beginner-friendly guide to building and assessing a classification model step by step.</p>
<section id="step-1-load-libraries">
<h2>Step 1: Load Libraries<a class="headerlink" href="#step-1-load-libraries" title="Link to this heading">#</a></h2>
<p>Before we begin working on machine learning tasks in R, we need to install and load several essential packages:</p>
<p>These commands install the following libraries:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tidyverse</span></code></strong>: A collection of R packages designed for data science. It includes tools like <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>, <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>, and <code class="docutils literal notranslate"><span class="pre">readr</span></code> for data manipulation and visualization.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">caret</span></code></strong>: Short for <em>Classification And Regression Training</em>, this package provides a unified interface for building and evaluating machine learning models.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">randomForest</span></code></strong>: Implements the Random Forest algorithm, a popular ensemble method for classification and regression tasks.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">corrplot</span></code></strong>: A visualization tool to display correlation matrices in a clear and informative way.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;tidyverse&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;caret&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;randomForest&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;corrplot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once installed, we can load the libraries. This makes the functions from each package available in our R environment so we can use them in the rest of our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">caret</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">randomForest</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">corrplot</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-load-iris-dataset-a-built-in-dataset-in-r">
<h2>Step 2: Load Iris Dataset, a built-in dataset in R<a class="headerlink" href="#step-2-load-iris-dataset-a-built-in-dataset-in-r" title="Link to this heading">#</a></h2>
<p>We begin by loading the built-in <strong>Iris dataset</strong>, a classic dataset in R used for demonstrating machine learning techniques. It contains measurements of iris flowers from three species. We assign the dataset to a new variable <code class="docutils literal notranslate"><span class="pre">df</span></code> for convenience. To standardize our workflow, we rename the fifth column—originally labeled <code class="docutils literal notranslate"><span class="pre">Species</span></code>—to <code class="docutils literal notranslate"><span class="pre">target</span></code>, which is a common convention when preparing data for classification tasks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Iris Dataset, a built-in dataset in R</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span>

<span class="c1"># Rename target column for consistency; the column 5 (&quot;species&quot;) is renamed as &quot;target&quot;</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">df</span><span class="p">)[</span><span class="m">5</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;target&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-data-cleaning">
<h2>Step 3: Data Cleaning<a class="headerlink" href="#step-3-data-cleaning" title="Link to this heading">#</a></h2>
<p>Although the Iris dataset is well-structured and does not contain missing values, it’s still good practice to check for them before performing any data analysis or machine learning. We use the <code class="docutils literal notranslate"><span class="pre">anyNA(df)</span></code> function to quickly verify if any missing (<code class="docutils literal notranslate"><span class="pre">NA</span></code>) values are present in the dataset. This function returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if there are missing values and <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> otherwise, helping us ensure data quality before proceeding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># No missing values in iris; but check anyway; </span>
<span class="nf">anyNA</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">FALSE</div></div>
</div>
</section>
<section id="step-4-exploratory-data-analysis">
<h2>Step 4: Exploratory Data Analysis<a class="headerlink" href="#step-4-exploratory-data-analysis" title="Link to this heading">#</a></h2>
<p>Next, we explore the structure and basic characteristics of the dataset. The <code class="docutils literal notranslate"><span class="pre">str(df)</span></code> function reveals the number of rows and columns, the column names, and the data types of each column, giving us a quick overview of the dataset’s format. We follow this with <code class="docutils literal notranslate"><span class="pre">summary(df)</span></code>, which provides summary statistics—such as mean, median, min, and max—for each numerical feature, helping us understand the data’s distribution and scale. To visualize the class distribution of our target variable, we use <code class="docutils literal notranslate"><span class="pre">ggplot()</span></code> with <code class="docutils literal notranslate"><span class="pre">geom_bar()</span></code> to create a bar plot that shows how many examples belong to each iris species. Finally, we use the <code class="docutils literal notranslate"><span class="pre">corrplot()</span></code> function to create a heatmap showing the correlation between the four numerical features (sepal length, sepal width, petal length, and petal width). This helps us identify which features are strongly related, which can influence model performance and feature selection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># find the number of rows and columns, column names, and datatype of columns</span>
<span class="nf">str</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># find the summary statistics of all the numerical features</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Plot the number of classes in target variable (column y)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">target</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;steelblue&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Target Class Distribution&quot;</span><span class="p">)</span>

<span class="c1"># plot heatmap of correlation between all the features of dataset df; we are interested in the correlation between the features (X)</span>
<span class="nf">corrplot</span><span class="p">(</span><span class="nf">cor</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">&quot;color&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;upper&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tl.cex</span><span class="o">=</span><span class="m">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:	150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ target      : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
        target  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/dba5be7e8a27b89ba9d6d72fe718aded59089cd9ba3c2ef6cf28c840ef18f798.png"><img alt="../../../_images/dba5be7e8a27b89ba9d6d72fe718aded59089cd9ba3c2ef6cf28c840ef18f798.png" src="../../../_images/dba5be7e8a27b89ba9d6d72fe718aded59089cd9ba3c2ef6cf28c840ef18f798.png" style="width: 420px; height: 420px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/3479487583a212f007e469eba422772d931add36d5fe1895a8cc8c1dfc61030f.png"><img alt="../../../_images/3479487583a212f007e469eba422772d931add36d5fe1895a8cc8c1dfc61030f.png" src="../../../_images/3479487583a212f007e469eba422772d931add36d5fe1895a8cc8c1dfc61030f.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="step-5-split-the-data">
<h1>Step 5: Split the Data<a class="headerlink" href="#step-5-split-the-data" title="Link to this heading">#</a></h1>
<p>To prepare for training and evaluating our machine learning model, we split the dataset into training and testing sets. We use an 80/20 split, meaning 80% of the data is used to train the model and 20% is reserved for testing its performance. The <code class="docutils literal notranslate"><span class="pre">set.seed(42)</span></code> function ensures that the random split is reproducible, so results remain consistent each time the code is run. We then use <code class="docutils literal notranslate"><span class="pre">createDataPartition()</span></code> from the <strong><code class="docutils literal notranslate"><span class="pre">caret</span></code></strong> package to split the data while preserving the proportion of classes in the target variable. The resulting <code class="docutils literal notranslate"><span class="pre">train</span></code> and <code class="docutils literal notranslate"><span class="pre">test</span></code> datasets will be used for building and evaluating our classification model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the data randomly into training and testing set in 80/20 ratio. We could split it in 70/30 or 75/25 ratio also.</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w"> </span><span class="c1"># set a random seed to replicate the results</span>
<span class="n">trainIndex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataPartition</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">trainIndex</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">trainIndex</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="step-6-feature-scaling">
<h2>Step 6: Feature Scaling<a class="headerlink" href="#step-6-feature-scaling" title="Link to this heading">#</a></h2>
<p>Before training our model, we apply <strong>feature scaling</strong> to ensure that all numerical features contribute equally. Features in a dataset can have very different ranges—for example, one may range from 0 to 1, while another ranges up to 2500. Without scaling, features with larger magnitudes could disproportionately influence the model. To address this, we use the <code class="docutils literal notranslate"><span class="pre">preProcess()</span></code> function from the <strong><code class="docutils literal notranslate"><span class="pre">caret</span></code></strong> package to <strong>center</strong> (subtract the mean) and <strong>scale</strong> (divide by standard deviation) the feature columns in the training set. We then apply the same transformation to both the training and testing feature sets using <code class="docutils literal notranslate"><span class="pre">predict()</span></code>. Importantly, only the numerical features are scaled—not the target labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 6: Feature Scaling</span>
<span class="c1">#Numerical value of feature may be of different magnitudes (for example, max value of  &quot;mean smoothness&quot; is 0.163400 wheras max value &quot;mean area&quot; is 2501.00. </span>
<span class="c1">#Hence, we scale the features to transform them to a similar scale (between 0 and 1), </span>
<span class="c1">#so the feature with high numerical values does not dominate the model creation. Only feature values are scaled, NOT the target values.```</span>
<span class="n">preproc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">preProcess</span><span class="p">(</span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scale&quot;</span><span class="p">))</span>
<span class="n">train_scaled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">preproc</span><span class="p">,</span><span class="w"> </span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span>
<span class="n">test_scaled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">preproc</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-7-train-classifier">
<h2>Step 7: Train Classifier<a class="headerlink" href="#step-7-train-classifier" title="Link to this heading">#</a></h2>
<p>With our features scaled and data split, we’re ready to train a classification model. In this example, we use the <strong>Random Forest</strong> algorithm, a powerful ensemble method that builds multiple decision trees and aggregates their predictions for improved accuracy and robustness. We train the model using the <code class="docutils literal notranslate"><span class="pre">randomForest()</span></code> function, providing the scaled training features (<code class="docutils literal notranslate"><span class="pre">train_scaled</span></code>) as input <code class="docutils literal notranslate"><span class="pre">x</span></code> and the target labels (<code class="docutils literal notranslate"><span class="pre">train$target</span></code>) as <code class="docutils literal notranslate"><span class="pre">y</span></code>. This step builds a classifier that learns patterns in the training data to distinguish between the iris species. While we’re using Random Forest here, other popular classifiers—such as Decision Trees, Logistic Regression, Naive Bayes, or XGBoost—could also be used depending on the problem and desired performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Classifier. For example, **[Random Forest](https://scikit-learn.org/stable/modules/ensemble.html#), [Decision Tree](https://scikit-learn.org/stable/modules/tree.html), [logistic Regression](https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression), [Naive Bayes](https://scikit-learn.org/stable/modules/naive_bayes.html), [XgBoost](https://scikit-learn.org/stable/modules/ensemble.html#)**, and many more</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">randomForest</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_scaled</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="o">$</span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-8-evaluate-model">
<h2>Step 8: Evaluate Model<a class="headerlink" href="#step-8-evaluate-model" title="Link to this heading">#</a></h2>
<p>After training the model, we evaluate its performance on the unseen test data. Using the <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function, we generate predictions for the scaled test features (<code class="docutils literal notranslate"><span class="pre">test_scaled</span></code>). We then compare these predictions against the true labels (<code class="docutils literal notranslate"><span class="pre">test$target</span></code>) by creating a <strong>confusion matrix</strong> with <code class="docutils literal notranslate"><span class="pre">confusionMatrix()</span></code> from the <strong>caret</strong> package. This matrix summarizes how well the model correctly classified each iris species, showing counts of true positives, false positives, true negatives, and false negatives, along with accuracy and other performance metrics. Evaluating on test data helps us understand how well the model generalizes to new, unseen samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate Model</span>
<span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_scaled</span><span class="p">)</span>
<span class="nf">confusionMatrix</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         10          0         0
  versicolor      0          9         1
  virginica       0          1         9

Overall Statistics
                                          
               Accuracy : 0.9333          
                 95% CI : (0.7793, 0.9918)
    No Information Rate : 0.3333          
    P-Value [Acc &gt; NIR] : 8.747e-12       
                                          
                  Kappa : 0.9             
                                          
 Mcnemar&#39;s Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9000           0.9000
Specificity                 1.0000            0.9500           0.9500
Pos Pred Value              1.0000            0.9000           0.9000
Neg Pred Value              1.0000            0.9500           0.9500
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3000           0.3000
Detection Prevalence        0.3333            0.3333           0.3333
Balanced Accuracy           1.0000            0.9250           0.9250
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./src/MachineLearning/RCode"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Machine Learning Tutorial in R: From Data Cleaning to Classification (Using Iris Dataset)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-load-libraries">Step 1: Load Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-load-iris-dataset-a-built-in-dataset-in-r">Step 2: Load Iris Dataset, a built-in dataset in R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-data-cleaning">Step 3: Data Cleaning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-exploratory-data-analysis">Step 4: Exploratory Data Analysis</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-split-the-data">Step 5: Split the Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-feature-scaling">Step 6: Feature Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-train-classifier">Step 7: Train Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-evaluate-model">Step 8: Evaluate Model</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By University of South Carolina Libraries
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>