
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Python Intermediate 2 &#8212; USC Libraries - DRS Resources for Data Literacy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'src/Python/intermediate/python-intermediate-2';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-light" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>
    <script>document.write(`<img src="../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-dark" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PythonForDataAnalysis/GettingStarted/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForDataAnalysis/GettingData/GettingData.html">Getting Data (APIs, Web Scraping)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForDataAnalysis/DataCleaningBasics/DataCleaning_Basics.html">Data Cleaning Basics</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PythonForDataAnalysis/DataVisualization/DataVisualization.html">Data Visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/IntroductionTextAnalysis.html">Introduction to Text Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/AdvancedTextAnalysis.html">Advanced Text Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/MultiLingualNer.html">Named Entity Recognition (NER)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/TextPreprocessing/TextPreprocessingMethods.html">Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../R_Code/Data_Wrangling.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TextMining/With_R/GettingStarted.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MachineLearning/PythonCode/Python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MachineLearning/RCode/R.html">R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AppDevelopment/AppDevelopment.html">Getting Started</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io/issues/new?title=Issue%20on%20page%20%2Fsrc/Python/intermediate/python-intermediate-2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/src/Python/intermediate/python-intermediate-2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Python Intermediate 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#files-in-python">Files in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-common-data-file-types">Three Common Data File Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plain-text-files-txt">Plain Text Files (.txt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comma-separated-value-files-csv">Comma-Separated Value Files (.csv)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-text-contents-of-a-sample-csv-file">The text contents of a sample CSV file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-csv-file-represented-in-google-sheets">The same CSV file represented in Google Sheets:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#javascript-object-notation-json">JavaScript Object Notation (.json)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-text-contents-of-a-sample-json-file">The text contents of a sample JSON file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-json-file-represented-in-json-editor-online">The same JSON file represented in JSON Editor Online</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-text-files-txt">Opening, Reading, and Writing Text Files (.txt)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-very-large-text-files-line-by-line">Reading Very Large Text Files (Line by Line)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chunking-file-reading-with-read">Chunking file reading with <code class="docutils literal notranslate"><span class="pre">.read()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-to-and-creating-files-with-write">Writing to and Creating Files with <code class="docutils literal notranslate"><span class="pre">.write()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-file-using-write-method-and-write-mode-w">Create a new file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and write mode (‘w’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-an-existing-file-with-using-write-method-and-read-write-mode-r">Modifying an existing file with using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and read+write mode (‘r+’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-to-an-existing-file-using-write-method-and-append-mode-a">Appending to an existing file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and append mode (‘a’)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-csv-files-csv">Opening, Reading, and Writing CSV Files (.csv)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-json-files-json">Opening, Reading, and Writing JSON Files (.json)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-datasets-with-constellate-client">Opening datasets with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metadata-csv-vs-json-lines-data-file">Metadata CSV vs. JSON Lines Data File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-sampled-data-constellate-client-methods">Retrieving sampled data (<code class="docutils literal notranslate"><span class="pre">constellate</span></code> client methods)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-the-full-dataset-with-constellate-client">Retrieving the full dataset with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-in-data-from-a-dataset-object">Reading in data from a dataset object</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-complete">Lesson Complete</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-next-lesson-python-intermediate-3">Start Next Lesson: <span class="xref myst">Python Intermediate 3</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-solutions">Exercise Solutions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img align="left" src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/CC_BY.png"><br /></p>
<p>Created by <a class="reference external" href="http://nkelber.com">Nathan Kelber</a> and Ted Lawless for <a class="reference external" href="https://labs.jstor.org/">JSTOR Labs</a> under <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons CC BY License</a><br />
For questions/comments/improvements, email <a class="reference external" href="mailto:nathan&#46;kelber&#37;&#52;&#48;ithaka&#46;org">nathan<span>&#46;</span>kelber<span>&#64;</span>ithaka<span>&#46;</span>org</a>.<br /></p>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="python-intermediate-2">
<h1>Python Intermediate 2<a class="headerlink" href="#python-intermediate-2" title="Link to this heading">#</a></h1>
<p><strong>Description:</strong> This notebook describes how to:</p>
<ul class="simple">
<li><p>Read and write files (.txt, .csv, .json)</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client to read in metadata</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client to read in data</p></li>
</ul>
<p>This notebook describes how to read and write text, CSV, and JSON files using Python. Additionally, it explains how the <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client can help users easily load and analyze their datasets.</p>
<p><strong>Use Case:</strong> For Learners (Detailed explanation, not ideal for researchers)</p>
<p><strong>Difficulty:</strong> Intermediate</p>
<p><strong>Completion Time:</strong> 90 minutes</p>
<p><strong>Knowledge Required:</strong></p>
<ul class="simple">
<li><p>Python Basics (<a class="reference internal" href="../basic/python-basics-1.html"><span class="std std-doc">Start Python Basics I</span></a>)</p></li>
</ul>
<p><strong>Knowledge Recommended:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="python-intermediate-1.html"><span class="std std-doc">Python Intermediate 1</span></a></p></li>
</ul>
<p><strong>Data Format:</strong> Text (.txt), CSV (.csv), JSON (.json)</p>
<p><strong>Libraries Used:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/">pandas</a> to read and write CSV files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">json</span></code> to read and write JSON files</p></li>
<li><p>constellate client to retrieve and read data</p></li>
</ul>
<p><strong>Research Pipeline:</strong> None</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Download Sample Files for this Lesson</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Check if a data folder exists. If not, create it.</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/&#39;</span><span class="p">)</span>
<span class="n">data_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">download_urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/sample.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/sample.txt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/adaptation.txt&#39;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">download_urls</span><span class="p">:</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;../data/&#39;</span> <span class="o">+</span> <span class="n">url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample files ready.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample files ready.
</pre></div>
</div>
</div>
</div>
<section id="files-in-python">
<h2>Files in Python<a class="headerlink" href="#files-in-python" title="Link to this heading">#</a></h2>
<p>Working with files is an essential part of Python programming. When we execute code in Python, we manipulate data through the use of variables. When the program is closed, however, any data stored in those variables is erased. To save the information stored in variables, we must learn how to write it to a file.</p>
<p>At the same time, we may have notebooks for applying specific analyses, but we need to have a way to bring data into the notebook for analysis. Otherwise, we would have to type all the data into the program ourselves! Both reading-in from files and writing-out data to files are important skills for data science and the digital humanities.</p>
<p>This section describes how to work with three kinds of common data files in Python:</p>
<ul class="simple">
<li><p>Plain Text Files (.txt)</p></li>
<li><p>Comma-Separated Value files (.csv)</p></li>
<li><p>Javascript Object Notation files (.json)</p></li>
</ul>
<p>Each of these filetypes are in wide use in data science, digital humanities, and general programming.</p>
</section>
<section id="three-common-data-file-types">
<h2>Three Common Data File Types<a class="headerlink" href="#three-common-data-file-types" title="Link to this heading">#</a></h2>
<section id="plain-text-files-txt">
<h3>Plain Text Files (.txt)<a class="headerlink" href="#plain-text-files-txt" title="Link to this heading">#</a></h3>
<p>A plain text file is one of the simplest kinds of computer files. Plain text files can be opened with a text editor like Notepad (Windows 10) or TextEdit (OS X). The file can contain only basic textual characters such as: letters, numbers, spaces, and line breaks. Plain text files do not contain styling such as: heading sizes, italic, bold, or specialized fonts. (To including styling in a text file, writers may use other file formats such as rich text format (.rtf) or markdown (.md).)</p>
<p>Plain text files (.txt) can be easily viewed and modified by humans by changing the text within. This is an important distinction from binary files such as images (.jpg), archives (.gzip), audio (.wav), or video (.mp4). If a binary file is opened with a text editor, the content will be largely unreadable.</p>
</section>
<section id="comma-separated-value-files-csv">
<h3>Comma-Separated Value Files (.csv)<a class="headerlink" href="#comma-separated-value-files-csv" title="Link to this heading">#</a></h3>
<p>A comma-separated value file is also a text file that can easily be modifed with a text editor. A CSV file is generally used to store data that fits in a series or table (like a list or spreadsheet). A spreadsheet application (like Microsoft Excel or Google Sheets) will allow you to view and edit a CSV data in the form of a table.</p>
<p>Each row of a CSV file represents a single row of a table. The values in a CSV are separated by commas (with no space between), but other delimiters can be chosen such as a tab or pipe (|). A tab-separated value file is called a TSV file (.tsv). Using tabs or pipes may be preferable if the data being stored contains commas (since this could make it confusing whether a comma is part of a single entry or a delimiter between entries).</p>
<section id="the-text-contents-of-a-sample-csv-file">
<h4>The text contents of a sample CSV file<a class="headerlink" href="#the-text-contents-of-a-sample-csv-file" title="Link to this heading">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Username</span><span class="p">,</span><span class="n">Login</span> <span class="n">email</span><span class="p">,</span><span class="n">Identifier</span><span class="p">,</span><span class="n">First</span> <span class="n">name</span><span class="p">,</span><span class="n">Last</span> <span class="n">name</span>
<span class="n">booker12</span><span class="p">,</span><span class="n">rachel</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="mi">9012</span><span class="p">,</span><span class="n">Rachel</span><span class="p">,</span><span class="n">Booker</span>
<span class="n">grey07</span><span class="p">,,</span><span class="mi">2070</span><span class="p">,</span><span class="n">Laura</span><span class="p">,</span><span class="n">Grey</span>
<span class="n">johnson81</span><span class="p">,,</span><span class="mi">4081</span><span class="p">,</span><span class="n">Craig</span><span class="p">,</span><span class="n">Johnson</span>
<span class="n">jenkins46</span><span class="p">,</span><span class="n">mary</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="mi">9346</span><span class="p">,</span><span class="n">Mary</span><span class="p">,</span><span class="n">Jenkins</span>
<span class="n">smith79</span><span class="p">,</span><span class="n">jamie</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="mi">5079</span><span class="p">,</span><span class="n">Jamie</span><span class="p">,</span><span class="n">Smith</span>
</pre></div>
</div>
</section>
<section id="the-same-csv-file-represented-in-google-sheets">
<h4>The same CSV file represented in Google Sheets:<a class="headerlink" href="#the-same-csv-file-represented-in-google-sheets" title="Link to this heading">#</a></h4>
<p><img alt="CSV table view in Google Sheets" src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/csv_in_sheets.png" /></p>
</section>
</section>
<section id="javascript-object-notation-json">
<h3>JavaScript Object Notation (.json)<a class="headerlink" href="#javascript-object-notation-json" title="Link to this heading">#</a></h3>
<p>A Javascript Object Notation file is also a text file that can be modified with a text editor. A JSON file stores data in key/value pairs, very similar to a Python dictionary. One of the key benefits of JSON is its compactness which makes it ideal for exchanging data between web browsers and servers.</p>
<p>While smaller JSON files can be opened in a text editor, larger files can be difficult to read. Viewing and editing JSON is easier in specialized editors, available online at sites like:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://jsonformatter.org">JSON Formatter</a></p></li>
<li><p><a class="reference external" href="https://jsoneditoronline.org/">JSON Editor Online</a></p></li>
</ul>
<p>A JSON file has a nested structure, where smaller concepts are grouped under larger ones. Like extensible markup language (.xml), a JSON file can be checked to determine that it is valid (follows the proper format for JSON) and/or well-formed (follows the proper format defined in a specialized example, called a schema).</p>
<section id="the-text-contents-of-a-sample-json-file">
<h4>The text contents of a sample JSON file<a class="headerlink" href="#the-text-contents-of-a-sample-json-file" title="Link to this heading">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Julia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;streetAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;11434&quot;</span><span class="p">,</span>
        <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Detroit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;Mi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;postalCode&quot;</span><span class="p">:</span> <span class="s2">&quot;48202&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;phoneNumbers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;home&quot;</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;7383627627&quot;</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="the-same-json-file-represented-in-json-editor-online">
<h4>The same JSON file represented in JSON Editor Online<a class="headerlink" href="#the-same-json-file-represented-in-json-editor-online" title="Link to this heading">#</a></h4>
<p><img alt="An image of the JSON file showing the structure" src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/json_editor.png" /></p>
</section>
</section>
</section>
<section id="opening-reading-and-writing-text-files-txt">
<h2>Opening, Reading, and Writing Text Files (.txt)<a class="headerlink" href="#opening-reading-and-writing-text-files-txt" title="Link to this heading">#</a></h2>
<p>Before we can read or write to a text file, we must open the file. Normally, when we open a file, a new window appears where we can see the file contents. In Python, opening a file means creating a <em>file object</em> that references the particular file. When the file has been opened, we can read or write to the file using the file object. Finally, we must close the file. Here are the three steps:</p>
<ol class="arabic simple">
<li><p>Open the file using <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">open()</span></code> using read <code class="docutils literal notranslate"><span class="pre">r</span></code>, write <code class="docutils literal notranslate"><span class="pre">w</span></code>, read+write <code class="docutils literal notranslate"><span class="pre">r+</span></code> or append <code class="docutils literal notranslate"><span class="pre">a</span></code> mode</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">.read()</span></code> or <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method on the file object</p></li>
<li><p>Let the code block close which automatically closes the file</p></li>
</ol>
<p>Let’s practice on <code class="docutils literal notranslate"><span class="pre">sample.txt</span></code>, a sample text file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Opening a file in read mode</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A text file can have many words in it
These words are written on the second line
Third line
Fourth line
Fifth line
Sixth line
Seventh line
Eighth line
Ninth line
Tenth line. This is the end of the text file!
</pre></div>
</div>
</div>
</div>
<p>We have created a file object called <code class="docutils literal notranslate"><span class="pre">f</span></code>. The first argument (<code class="docutils literal notranslate"><span class="pre">'data/sample.txt'</span></code>) passed into the <code class="docutils literal notranslate"><span class="pre">open()</span></code> function is a string containing the file name. You can see the sample.txt is in the data directory in the file browser to the left. If your file was called reports.txt, you would replace that argument with <code class="docutils literal notranslate"><span class="pre">'data/reports.txt'</span></code>. The second argument (<code class="docutils literal notranslate"><span class="pre">'r'</span></code>) determines that we are opening the file in “read” mode, where the file can be read but not modified. There are four main modes that can be specified when creating a file object:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Mode Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘r’</p></td>
<td><p>read</p></td>
<td><p>Reads file but no writing allowed (protects file from modification)</p></td>
</tr>
<tr class="row-odd"><td><p>‘w’</p></td>
<td><p>write</p></td>
<td><p>Writes to file, overwriting any information in the file (saves over the current version of the file)</p></td>
</tr>
<tr class="row-even"><td><p>‘r+’</p></td>
<td><p>read+write</p></td>
<td><p>Makes the file object available for both reading and writing.</p></td>
</tr>
<tr class="row-odd"><td><p>‘a’</p></td>
<td><p>append</p></td>
<td><p>Appends (or adds) information to the end of the file (new information is added below old information)</p></td>
</tr>
</tbody>
</table>
</div>
<section id="reading-very-large-text-files-line-by-line">
<h3>Reading Very Large Text Files (Line by Line)<a class="headerlink" href="#reading-very-large-text-files-line-by-line" title="Link to this heading">#</a></h3>
<p>If the file is very large, we may want to read it one line at a time. To read a single line at a time, we can use a for loop instead of the <code class="docutils literal notranslate"><span class="pre">.read()</span></code> method. This is useful when you are working with large files that approach the amount of memory in your computer. This depends on your computer, but is probably about 8 GB or larger. (In a plain text file, that would be roughly 5.5 million pages.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Opening a file in read mode</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># By default each print inserts a line break, pass `end = &#39;&#39;` to remove this break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A text file can have many words in it
These words are written on the second line
Third line
Fourth line
Fifth line
Sixth line
Seventh line
Eighth line
Ninth line
Tenth line. This is the end of the text file!
</pre></div>
</div>
</div>
</div>
<h4 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h4>
<p>In the data folder is a poem called Adaptation by the 2022 American Poet Laureate, Ada Limón. The file is called <code class="docutils literal notranslate"><span class="pre">adaptation.txt</span></code>. Open the file and print it out line by line.</p>
<p>For a more difficult challenge, print the title and author before the poem along with a number for each line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read and print the poem found in /data/adaptation.txt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the title and author before the poem along with a number for each line</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chunking-file-reading-with-read">
<h3>Chunking file reading with <code class="docutils literal notranslate"><span class="pre">.read()</span></code><a class="headerlink" href="#chunking-file-reading-with-read" title="Link to this heading">#</a></h3>
<p>We can also read large files in chunks using <code class="docutils literal notranslate"><span class="pre">.read()</span></code> passing an argument that specifies the number of bytes to read in each chunk.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading a set number of bytes with .read()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">file_chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># Try changing the argument here</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_chunk</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">file_chunk</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A te
xt f
ile 
can 
have
 man
y wo
rds 
in i
t
Th
ese 
word
s ar
e wr
itte
n on
 the
 sec
ond 
line

Thi
rd l
ine

Four
th l
ine

Fift
h li
ne
S
ixth
 lin
e
Se
vent
h li
ne
E
ight
h li
ne
N
inth
 lin
e
Te
nth 
line
. Th
is i
s th
e en
d of
 the
 tex
t fi
le!
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-to-and-creating-files-with-write">
<h3>Writing to and Creating Files with <code class="docutils literal notranslate"><span class="pre">.write()</span></code><a class="headerlink" href="#writing-to-and-creating-files-with-write" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method can be used with a file opened in write mode (‘w’), read+write mode (‘r+), or append mode (‘a’). If you try to use the <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method on a file opened in read mode (‘r’), the write will fail and you will get a “not writable” error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trying to use `.write()` on a file in read mode</span>
<span class="c1"># will create an error</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Add this text to the file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">UnsupportedOperation</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Trying to use `.write()` on a file in read mode</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># will create an error</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Add this text to the file&#39;</span><span class="p">)</span>

<span class="ne">UnsupportedOperation</span>: not writable
</pre></div>
</div>
</div>
</div>
<p>If you want to use the <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method to write to a file, we demonstrate three common modes here: write (‘w’), read+write (‘r+’) and append (‘a’) mode.</p>
<p><strong>Choose write mode (‘w’) if:</strong></p>
<ul class="simple">
<li><p>You want to create a new text file and/or write data to it</p></li>
<li><p>You want to overwrite all data in the file</p></li>
</ul>
<p>Be careful with write mode, since it will write over any existing file!</p>
<p><strong>Choose read+write mode (‘r+’) if:</strong></p>
<ul class="simple">
<li><p>You need to both read and write data to a file</p></li>
<li><p>You are okay overwriting the file if it already exists</p></li>
<li><p>You want the file pointer at the beginning of the file</p></li>
</ul>
<p>Again, be careful with read+write mode (‘r+’) because it can overwrite existing data.</p>
<p><strong>Choose append mode (‘a’) if:</strong></p>
<ul class="simple">
<li><p>You simply need to add more data to a file</p></li>
<li><p>You want to protect existing data in the file from being overwritten</p></li>
</ul>
<p>There are also additional modes for working with a text file:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>Effect</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>w</p></td>
<td><p>Opens a file for writing only. Overwrites the file if the file exists. If the file does not exist, creates a new file for writing.</p></td>
</tr>
<tr class="row-odd"><td><p>r+</p></td>
<td><p>Opens a file for both reading and writing. The file pointer will be at the beginning of the file.</p></td>
</tr>
<tr class="row-even"><td><p>a</p></td>
<td><p>Opens a file for appending. The file pointer is at the end of the file if the file exists. That is, the file is in the append mode. If the file does not exist, it creates a new file for writing.</p></td>
</tr>
<tr class="row-odd"><td><p>w+</p></td>
<td><p>Opens a file for both writing and reading. Overwrites the existing file if the file exists. If the file does not exist, it creates a new file for reading and writing.</p></td>
</tr>
<tr class="row-even"><td><p>a+</p></td>
<td><p>Opens a file for both appending and reading. The file pointer is at the end of the file if the file exists. The file opens in the append mode. If the file does not exist, it creates a new file for reading and writing.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="create-a-new-file-using-write-method-and-write-mode-w">
<h4>Create a new file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and write mode (‘w’)<a class="headerlink" href="#create-a-new-file-using-write-method-and-write-mode-w" title="Link to this heading">#</a></h4>
<p>To create a new file, open a new file object in write mode. You may then use the <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method to add some initial data to the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new file and write a string to the file</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample_new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Put this string into the new file. &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modifying-an-existing-file-with-using-write-method-and-read-write-mode-r">
<h4>Modifying an existing file with using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and read+write mode (‘r+’)<a class="headerlink" href="#modifying-an-existing-file-with-using-write-method-and-read-write-mode-r" title="Link to this heading">#</a></h4>
<p>You can read and write to the same file by opening it in read+write mode (‘r+’).</p>
<h4 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h4>
<p>Open our <code class="docutils literal notranslate"><span class="pre">sample_new.txt</span></code> file, overwrite the word ‘Put’, the first three characters, with ‘Add’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading and writing to a file using read+write mode</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample_new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="appending-to-an-existing-file-using-write-method-and-append-mode-a">
<h4>Appending to an existing file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and append mode (‘a’)<a class="headerlink" href="#appending-to-an-existing-file-using-write-method-and-append-mode-a" title="Link to this heading">#</a></h4>
<p>Use the append mode if you want to be sure to preserve existing data in the file. Try appending some text onto the end of a file using append mode (‘a’).</p>
<h4 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h4>
<p>Open our <code class="docutils literal notranslate"><span class="pre">sample_new.txt</span></code> file again. Add a second sentence to the file without overwriting the current file contents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Appending to a file using the append mode (&#39;a&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="opening-reading-and-writing-csv-files-csv">
<h2>Opening, Reading, and Writing CSV Files (.csv)<a class="headerlink" href="#opening-reading-and-writing-csv-files-csv" title="Link to this heading">#</a></h2>
<p>CSV file data can be easily opened, read, and written using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library. (For large CSV files (&gt;500 mb), you may wish to use the <code class="docutils literal notranslate"><span class="pre">csv</span></code> library to read in a single row at a time to reduce the memory footprint.) Pandas is flexible for working with tabular data, and the process for importing and exporting to CSV is simple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import pandas </span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Create our dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/sample.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the dataframe</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Username         Login email  Identifier First name Last name
0   booker12  rachel@example.com        9012     Rachel    Booker
1     grey07                 NaN        2070      Laura      Grey
2  johnson81                 NaN        4081      Craig   Johnson
3  jenkins46    mary@example.com        9346       Mary   Jenkins
4    smith79   jamie@example.com        5079      Jamie     Smith
</pre></div>
</div>
</div>
</div>
<p>After you’ve made any necessary changes in Pandas, write the dataframe back to the CSV file. (Remember to always back up your data before writing over the file.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write data to new file</span>
<span class="c1"># Keeping the Header but removing the index</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/new_sample.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="opening-reading-and-writing-json-files-json">
<h2>Opening, Reading, and Writing JSON Files (.json)<a class="headerlink" href="#opening-reading-and-writing-json-files-json" title="Link to this heading">#</a></h2>
<p>JSON files use a key/value structure very similar to a Python dictionary. We will start with a Python dictionary called <code class="docutils literal notranslate"><span class="pre">py_dict</span></code> and then write the data to a JSON file using the <code class="docutils literal notranslate"><span class="pre">json</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining sample data in a Python dictionary</span>
<span class="n">py_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Julia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;woman&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;streetAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;11434&quot;</span><span class="p">,</span>
        <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Detroit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;Mi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;postalCode&quot;</span><span class="p">:</span> <span class="s2">&quot;48202&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;phoneNumber&quot;</span><span class="p">:</span> <span class="s2">&quot;3133627627&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>To write our dictionary to a JSON file, we will use the <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">open</span></code> technique we learned that automatically closes file objects. We also need the <code class="docutils literal notranslate"><span class="pre">json</span></code> library to help dump our dictionary data into the file object. The <code class="docutils literal notranslate"><span class="pre">json.dump</span></code> function works a little differently than the write method we saw with text files.</p>
<p>We need to specify two arguments:</p>
<ul class="simple">
<li><p>The data to be dumped</p></li>
<li><p>The file object where we are dumping</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open/create sample.json in write mode</span>
<span class="c1"># as the file object `f`. The data in py_dict</span>
<span class="c1"># is dumped into `f` and then `f` is closed</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">py_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To read data in from a JSON file, we can use the <code class="docutils literal notranslate"><span class="pre">json.load</span></code> function on our file object. Here we load all the content into a variable called <code class="docutils literal notranslate"><span class="pre">content</span></code>. We can then print values based on particular keys.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open the .json file in read mode</span>
<span class="c1"># and print the loaded contents</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;firstName&#39;: &#39;Julia&#39;, &#39;lastName&#39;: &#39;Smith&#39;, &#39;gender&#39;: &#39;woman&#39;, &#39;age&#39;: 57, &#39;address&#39;: {&#39;streetAddress&#39;: &#39;11434&#39;, &#39;city&#39;: &#39;Detroit&#39;, &#39;state&#39;: &#39;Mi&#39;, &#39;postalCode&#39;: &#39;48202&#39;}, &#39;phoneNumber&#39;: &#39;3133627627&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the current data from the file into a dictionary</span>
<span class="c1"># and add an entry to the dictionary</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">file_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">file_contents</span><span class="p">[</span><span class="s1">&#39;pet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dog&#39;</span>

<span class="c1"># Write the contents of the dictionary over the existing data </span>
    
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">file_contents</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.load()</span></code> method creates a Python dictionary from the .json file object. This means that we can query a particular key/value pair after loading the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the data from the json file into a dictionary</span>
<span class="c1"># Check to see if there is value associated with pet</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json_contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pet&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dog
</pre></div>
</div>
</div>
</div>
<h3 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h3>
<p>Add an entry to Julia Smith that indicates her favorite ice cream is chocolate peanut butter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add an ice cream entry to Julia Smith&#39;s record</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="opening-datasets-with-constellate-client">
<h2>Opening datasets with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client<a class="headerlink" href="#opening-datasets-with-constellate-client" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client helps retrieve a given dataset and/or its associated metadata. The metadata is supplied in a CSV file and the full dataset is supplied in a compressed JSON Lines file (.jsonl.gz). For analysis focused on metadata, we recommend users start with the CSV file since it is both easier and faster to view, parse, and manipulate. If you need access to n-grams or full-text, then you want the full JSON lines file.</p>
<section id="metadata-csv-vs-json-lines-data-file">
<h3>Metadata CSV vs. JSON Lines Data File<a class="headerlink" href="#metadata-csv-vs-json-lines-data-file" title="Link to this heading">#</a></h3>
<p>All of the textual data and metadata is available inside of the JSON Lines files, but we have chosen to offer the metadata CSV for two primary reasons:</p>
<ol class="arabic simple">
<li><p>The JSON Lines data is a little more complex to parse since it is nested. It cannot be easily represented in a table form in something like Pandas. It is nice to be able to easily view all the metadata in a Pandas dataframe.</p></li>
<li><p>The JSON Lines data can be very large. Each file contains all of the metadata <em>plus</em> unigram counts, bigram counts, trigram counts, and full-text (when available). Manipulating all that data takes significant computer time and costs. Even a modest dataset (~5000 files) can be over 1 GB in size uncompressed.</p></li>
</ol>
<p>More information is available, including the metadata categories, in the FAQ <a class="reference external" href="https://constellate.org/docs/constellate-dataset-typeshttps://constellate.org/docs/constellate-dataset-types">“What is the data file format?”</a>. There’s also reference documentation for <a class="reference external" href="https://constellate.org/docs/constellate-client">the <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client</a>.</p>
</section>
<section id="retrieving-sampled-data-constellate-client-methods">
<h3>Retrieving sampled data (<code class="docutils literal notranslate"><span class="pre">constellate</span></code> client methods)<a class="headerlink" href="#retrieving-sampled-data-constellate-client-methods" title="Link to this heading">#</a></h3>
<p>By passing the <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client a dataset ID (here called <code class="docutils literal notranslate"><span class="pre">dataset_id</span></code>), we can automatically download the metadata CSV file or the full JSON Lines dataset created by the <a class="reference external" href="https://constellate.org/builder/">dataset builder</a>. By default, these datasets are randomly sampled to 1500 documents. Experience has shown us that this is the right size for teaching/learning where data loads quickly and still gives interesting results.</p>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">.get_metadata()</span></code> method to retrieve the sampled metadata CSV file</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">.get_dataset()</span></code> method to retrieve the sampled JSON data file</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>f = constellate.get_metadata(dataset_id)</p></td>
<td><p>Automatically retrieves a sampled metadata CSV file and creates a file object <code class="docutils literal notranslate"><span class="pre">f</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>f = constellate.get_dataset(dataset_id)</p></td>
<td><p>Automatically retrieves a sampled, compressed JSON Lines dataset file (jsonl.gz) and creates a file object <code class="docutils literal notranslate"><span class="pre">f</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The JSON Lines file will be downloaded in a compressed gzip format (jsonl.gz). We can iterate over each document in the corpus by using the <code class="docutils literal notranslate"><span class="pre">dataset_reader()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Downloading and reading a Constellate dataset</span>
<span class="c1"># If using locally, pip install constellate-client</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">constellate</span>

<span class="c1"># Setting a dataset ID based on the journal Shakespeare Quarterly.</span>
<span class="n">dataset_id</span> <span class="o">=</span> <span class="s2">&quot;2880ef54-b3b5-c0af-2ef1-ad557f236b5e&quot;</span>

<span class="c1"># Pull in our dataset CSV using</span>
<span class="c1"># The .get_metadata() method downloads the CSV file for our metadata</span>
<span class="c1"># to the /data folder and returns a string for the file name and location</span>
<span class="c1"># dataset_metadata will be a string containing that file name and location</span>
<span class="n">dataset_metadata</span> <span class="o">=</span> <span class="n">constellate</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>

<span class="c1"># Pull in the sampled dataset (1500 documents) that matches `dataset_id`</span>
<span class="c1"># in the form of a gzipped JSON lines file.</span>
<span class="c1"># The .get_dataset() method downloads the gzipped JSONL file</span>
<span class="c1"># to the /data folder and returns a string for the file name and location</span>
<span class="n">dataset_file</span> <span class="o">=</span> <span class="n">constellate</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="retrieving-the-full-dataset-with-constellate-client">
<h3>Retrieving the full dataset with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client<a class="headerlink" href="#retrieving-the-full-dataset-with-constellate-client" title="Link to this heading">#</a></h3>
<p>Researchers wishing to work with larger datasets (up to 25,000 items), first need to request these datasets be built.</p>
<p><img alt="From the dataset dashboard, select &quot;download&quot; then &quot;More Download Options&quot;" src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/request-dataset.png" /></p>
<p>Then you can request the full dataset using the <code class="docutils literal notranslate"><span class="pre">constellate.download</span></code> method. For more information, see <a class="reference external" href="https://constellate.org/docs/constellate-client">the Constellate Client reference documentation</a>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>f = constellate.download(dataset_id, ‘metadata’)</p></td>
<td><p>Automatically retrieves a full metadata CSV file and creates a file object <code class="docutils literal notranslate"><span class="pre">f</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>f = constellate.download(dataset_id, ‘jsonl’)</p></td>
<td><p>Automatically retrieves the full compressed JSON Lines dataset file (jsonl.gz) and creates a file object <code class="docutils literal notranslate"><span class="pre">f</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To download the full dataset metadata (up to a limit of 25,000 documents),</span>
<span class="c1"># request it first in the builder environment. See the Constellate Client</span>
<span class="c1"># documentation at: https://constellate.org/docs/constellate-client</span>
<span class="c1"># Then use the `constellate.download` method show below.</span>
<span class="n">dataset_metadata</span> <span class="o">=</span> <span class="n">constellate</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="s1">&#39;metadata&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To download the full dataset (up to a limit of 25,000 documents),</span>
<span class="c1"># request it first in the builder environment. See the Constellate Client</span>
<span class="c1"># documentation at: https://constellate.org/docs/constellate-client</span>
<span class="c1"># Then use the `constellate.download` method show below.</span>
<span class="n">dataset_file</span> <span class="o">=</span> <span class="n">constellate</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="s1">&#39;jsonl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you would like to work with a CSV file, pass the file object into Pandas <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a pandas dataframe from a metadata CSV file</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Create our dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_metadata</span><span class="p">)</span>

<span class="c1"># Preview our dataframe</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-in-data-from-a-dataset-object">
<h3>Reading in data from a dataset object<a class="headerlink" href="#reading-in-data-from-a-dataset-object" title="Link to this heading">#</a></h3>
<p>When working with a Constellate JSON file, it is best to iterate over each line (representing all the data for a given document) using the dataset_reader method and a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dataset_reader()</span></code> method will read in data from the compressed JSON dataset file object. By keeping the data in a compressed format and reading in a single line at a time, we reduce the processing time and memory use. These can be substantial for large datasets.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dataset_reader()</span></code> essentially unzips each row/document and loads it into a dictionary. Each dictionary will contain all the metadata and data available for the current document.</p>
<p>In practice, that looks like:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>for document in constellate.dataset_reader(dataset_file):</p></td>
<td><p>Load all the data for a document into a dictionary, one by one</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop over every document in the dataset</span>
<span class="c1"># and print the title</span>

<span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">constellate</span><span class="o">.</span><span class="n">dataset_reader</span><span class="p">(</span><span class="n">dataset_file</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="lesson-complete">
<h2>Lesson Complete<a class="headerlink" href="#lesson-complete" title="Link to this heading">#</a></h2>
<p>Congratulations! You have completed <em>Python Intermediate 2</em>.</p>
<section id="start-next-lesson-python-intermediate-3">
<h3>Start Next Lesson: <a class="reference internal" href="python-intermediate-3.html"><span class="std std-doc">Python Intermediate 3</span></a><a class="headerlink" href="#start-next-lesson-python-intermediate-3" title="Link to this heading">#</a></h3>
</section>
<section id="exercise-solutions">
<h3>Exercise Solutions<a class="headerlink" href="#exercise-solutions" title="Link to this heading">#</a></h3>
<p>Here are a few solutions for exercises in this lesson.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read and print the poem found in /data/adaptation.txt</span>

<span class="c1"># Create a variable to store the line</span>
<span class="n">line_number</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADAPTATION&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ada Limón</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/adaptation.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line_number</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading and writing to a file using read+write mode (&#39;r+&#39;)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample_new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Appending to a file using the append mode (&#39;a&#39;)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample_new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A new sentence is added now.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the current data from the file into a dictionary</span>
<span class="c1"># and add an entry to the dictionary</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">file_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">file_contents</span><span class="p">[</span><span class="s1">&#39;favoriteIceCream&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chocolate peanut butter&#39;</span>

<span class="c1"># Write the contents of the dictionary over the existing data </span>
    
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">file_contents</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/sample.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json_contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;favoriteIceCream&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./src/Python/intermediate"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#files-in-python">Files in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-common-data-file-types">Three Common Data File Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plain-text-files-txt">Plain Text Files (.txt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comma-separated-value-files-csv">Comma-Separated Value Files (.csv)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-text-contents-of-a-sample-csv-file">The text contents of a sample CSV file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-csv-file-represented-in-google-sheets">The same CSV file represented in Google Sheets:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#javascript-object-notation-json">JavaScript Object Notation (.json)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-text-contents-of-a-sample-json-file">The text contents of a sample JSON file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-json-file-represented-in-json-editor-online">The same JSON file represented in JSON Editor Online</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-text-files-txt">Opening, Reading, and Writing Text Files (.txt)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-very-large-text-files-line-by-line">Reading Very Large Text Files (Line by Line)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chunking-file-reading-with-read">Chunking file reading with <code class="docutils literal notranslate"><span class="pre">.read()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-to-and-creating-files-with-write">Writing to and Creating Files with <code class="docutils literal notranslate"><span class="pre">.write()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-file-using-write-method-and-write-mode-w">Create a new file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and write mode (‘w’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-an-existing-file-with-using-write-method-and-read-write-mode-r">Modifying an existing file with using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and read+write mode (‘r+’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-to-an-existing-file-using-write-method-and-append-mode-a">Appending to an existing file using <code class="docutils literal notranslate"><span class="pre">.write()</span></code> method and append mode (‘a’)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-csv-files-csv">Opening, Reading, and Writing CSV Files (.csv)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-reading-and-writing-json-files-json">Opening, Reading, and Writing JSON Files (.json)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-datasets-with-constellate-client">Opening datasets with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metadata-csv-vs-json-lines-data-file">Metadata CSV vs. JSON Lines Data File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-sampled-data-constellate-client-methods">Retrieving sampled data (<code class="docutils literal notranslate"><span class="pre">constellate</span></code> client methods)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-the-full-dataset-with-constellate-client">Retrieving the full dataset with <code class="docutils literal notranslate"><span class="pre">constellate</span></code> client</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-in-data-from-a-dataset-object">Reading in data from a dataset object</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-complete">Lesson Complete</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-next-lesson-python-intermediate-3">Start Next Lesson: <span class="xref myst">Python Intermediate 3</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-solutions">Exercise Solutions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By University of South Carolina Libraries
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>