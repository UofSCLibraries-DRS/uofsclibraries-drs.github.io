
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pandas Basics 1 &#8212; USC Libraries - DRS Resources for Data Literacy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'src/PythonForDataAnalysis/GettingStarted/pandas/pandas-1';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-light" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>
    <script>document.write(`<img src="../../../../_static/USC_Libraries_logo_horizontal_RGB_2C.png" class="logo__image only-dark" alt="USC Libraries - DRS Resources for Data Literacy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GettingData/GettingData.html">Getting Data (APIs, Web Scraping)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DataCleaningBasics/DataCleaning_Basics.html">Data Cleaning Basics</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../DataVisualization/DataVisualization.html">Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProjectExamples/Quantitative_Analysis.html">Project Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../PythonForTextAnalysis/GettingStarted/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PythonForTextAnalysis/Advanced/AdvancedTextAnalysis.html">Advanced Text Analysis</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../../PythonForTextAnalysis/ProjectExamples/TextPreprocessingMethods.html">Project Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../RForDataAnalysis/Data_Wrangling.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R for Text Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../RForTextAnalysis/GettingStarted/GettingStarted.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../MachineLearning/PythonCode/Python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MachineLearning/RCode/R.html">R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../AppDevelopment/AppDevelopment.html">Getting Started</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UofSCLibraries-DRS/uofsclibraries-drs.github.io/issues/new?title=Issue%20on%20page%20%2Fsrc/PythonForDataAnalysis/GettingStarted/pandas/pandas-1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/src/PythonForDataAnalysis/GettingStarted/pandas/pandas-1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pandas Basics 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series-and-pandas-dataframe">Pandas Series and Pandas DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series">Pandas Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe">Pandas DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-data">Explore the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-write-tabular-data-in-pandas">Read and write tabular data in Pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data">Access data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-indexers-iloc-and-loc">The indexers <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iloc">.iloc</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loc">.loc</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-indexers-iat-and-at">The indexers <code class="docutils literal notranslate"><span class="pre">.iat</span></code> and <code class="docutils literal notranslate"><span class="pre">.at</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-values">Set values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-indexers-to-set-values">Use the indexers to set values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-column-based-on-an-existing-one">Create a new column based on an existing one</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-complete">Lesson Complete</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-next-lesson-pandas-2">Start Next Lesson: <span class="xref myst">Pandas 2 -&gt;</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-solutions">Exercise Solutions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img align="left" src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/CC_BY.png"><br /></p>
<p>This notebook is adapted by Zhuo Chen from the notebooks created by <a class="reference external" href="https://github.com/ithaka/tdm-notebooks/blob/e6275296c010280909e90e3ea47922d52d99c5a7/pandas-1.ipynb">Nathan Kelber</a>, <a class="reference external" href="https://github.com/wjbmattingly/tap-2022-pandas">William Mattingly</a> and <a class="reference external" href="https://github.com/melaniewalsh/Data-Analysis-with-Pandas">Melanie Walsh</a> under <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons CC BY License</a>.<br /></p>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="pandas-basics-1">
<h1>Pandas Basics 1<a class="headerlink" href="#pandas-basics-1" title="Link to this heading">#</a></h1>
<p><strong>Description:</strong> This notebook describes how to:</p>
<ul class="simple">
<li><p>Create a Pandas Series or a DataFrame</p></li>
<li><p>Create a dataframe from files of different formats</p></li>
<li><p>Explore the data in a dataframe</p></li>
<li><p>Access data from a dataframe</p></li>
<li><p>Set values in a dataframe</p></li>
<li><p>Create a new column based on an existing one</p></li>
</ul>
<p>This is the first notebook in a series on learning to use Pandas.</p>
<p><strong>Knowledge Required:</strong></p>
<ul class="simple">
<li><p>Python Basics (<a class="reference internal" href="../basic/python-basics-1.html"><span class="std std-doc">Start Python Basics I</span></a>)</p></li>
</ul>
<p><strong>Knowledge Recommended:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="../intermediate/python-intermediate-2.html"><span class="std std-doc">Python Intermediate 2</span></a></p></li>
<li><p><a class="reference internal" href="../intermediate/python-intermediate-4.html"><span class="std std-doc">Python Intermediate 4</span></a></p></li>
</ul>
<hr class="docutils" />
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<center><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ed/Pandas_logo.svg/1200px-Pandas_logo.svg.png" width="500"></center><p>Pandas is a Python library that allows you to easily work with tabular data. Most people are familiar with commercial spreadsheet software, such as Microsoft Excel or Google Sheets. While spreadsheet software and Pandas can accomplish similar tasks, each has significant advantages depending on the use-case.</p>
<p><strong>Advantages of Spreadsheet Software</strong></p>
<ul class="simple">
<li><p>Point and click</p></li>
<li><p>Easier to learn</p></li>
<li><p>Great for small datasets (&lt;10,000 rows)</p></li>
<li><p>Better for browsing data</p></li>
</ul>
<p><strong>Advantages of Pandas</strong></p>
<ul class="simple">
<li><p>More powerful data manipulation with Python</p></li>
<li><p>Can work with large datasets (millions of rows)</p></li>
<li><p>Faster for complicated manipulations</p></li>
<li><p>Better for cleaning and/or pre-processing data</p></li>
<li><p>Can automate workflows in a larger data pipeline</p></li>
</ul>
<p>In short, spreadsheet software is better for browsing small datasets and making moderate adjustments. Pandas is better for automating data cleaning processes that require large or complex data manipulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import pandas, `as pd` allows us to shorten typing `pandas` to `pd` when we call pandas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pandas-series-and-pandas-dataframe">
<h2>Pandas Series and Pandas DataFrame<a class="headerlink" href="#pandas-series-and-pandas-dataframe" title="Link to this heading">#</a></h2>
<p>In Pandas, data are stored in two fundamental objects:</p>
<ul class="simple">
<li><p><strong>Pandas Series</strong> - a single column or row of data</p></li>
<li><p><strong>Pandas DataFrame</strong> - a table of data containing multiple columns and rows</p></li>
</ul>
<section id="pandas-series">
<h3>Pandas Series<a class="headerlink" href="#pandas-series" title="Link to this heading">#</a></h3>
<p>We can think of a Series as a single column or row of data. Here we have a column called <code class="docutils literal notranslate"><span class="pre">Champions</span></code> with the country names of the winners of the most recent ten FIFA world cup games.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Champions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Argentina</p></td>
</tr>
<tr class="row-odd"><td><p>France</p></td>
</tr>
<tr class="row-even"><td><p>Germany</p></td>
</tr>
<tr class="row-odd"><td><p>Spain</p></td>
</tr>
<tr class="row-even"><td><p>Italy</p></td>
</tr>
<tr class="row-odd"><td><p>Brazil</p></td>
</tr>
<tr class="row-even"><td><p>France</p></td>
</tr>
<tr class="row-odd"><td><p>Brazil</p></td>
</tr>
<tr class="row-even"><td><p>Germany</p></td>
</tr>
<tr class="row-odd"><td><p>Argentina</p></td>
</tr>
</tbody>
</table>
</div>
<p>Let’s create a Series based on this column. To create our Series, we pass a <strong>list</strong> into the <code class="docutils literal notranslate"><span class="pre">.Series()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a data series object in Pandas</span>
<span class="n">champions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Argentina&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Spain&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Italy&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;Germany&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Argentina&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a look at the Series</span>
<span class="n">champions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Argentina
1       France
2      Germany
3        Spain
4        Italy
5       Brazil
6       France
7       Brazil
8      Germany
9    Argentina
dtype: object
</pre></div>
</div>
</div>
</div>
<p>As you can see, except the data column, we also have an index column. By default, the indexes are numbers starting from 0. We could define the indexes ourselves. To do that, we will pass a <strong>dictionary</strong> to the <code class="docutils literal notranslate"><span class="pre">.Series()</span></code> method. The keys of the dictionary will be used as indexes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use self-defined indexes</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="mi">2022</span><span class="p">:</span> <span class="s2">&quot;Argentina&quot;</span><span class="p">,</span> 
           <span class="mi">2018</span><span class="p">:</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
           <span class="mi">2014</span><span class="p">:</span> <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
           <span class="mi">2010</span><span class="p">:</span> <span class="s2">&quot;Spain&quot;</span><span class="p">,</span> 
           <span class="mi">2006</span><span class="p">:</span> <span class="s2">&quot;Italy&quot;</span><span class="p">,</span> 
           <span class="mi">2002</span><span class="p">:</span> <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
           <span class="mi">1998</span><span class="p">:</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
           <span class="mi">1994</span><span class="p">:</span> <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
           <span class="mi">1990</span><span class="p">:</span> <span class="s2">&quot;Germany&quot;</span><span class="p">,</span>
           <span class="mi">1986</span><span class="p">:</span> <span class="s2">&quot;Argentina&quot;</span><span class="p">}</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022    Argentina
2018       France
2014      Germany
2010        Spain
2006        Italy
2002       Brazil
1998       France
1994       Brazil
1990      Germany
1986    Argentina
dtype: object
</pre></div>
</div>
</div>
</div>
<p>You can give a name to your Pandas Series using the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># give a name to the series</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="mi">2022</span><span class="p">:</span> <span class="s2">&quot;Argentina&quot;</span><span class="p">,</span> 
           <span class="mi">2018</span><span class="p">:</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
           <span class="mi">2014</span><span class="p">:</span> <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
           <span class="mi">2010</span><span class="p">:</span> <span class="s2">&quot;Spain&quot;</span><span class="p">,</span> 
           <span class="mi">2006</span><span class="p">:</span> <span class="s2">&quot;Italy&quot;</span><span class="p">,</span> 
           <span class="mi">2002</span><span class="p">:</span> <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
           <span class="mi">1998</span><span class="p">:</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
           <span class="mi">1994</span><span class="p">:</span> <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
           <span class="mi">1990</span><span class="p">:</span> <span class="s2">&quot;Germany&quot;</span><span class="p">,</span>
           <span class="mi">1986</span><span class="p">:</span> <span class="s2">&quot;Argentina&quot;</span><span class="p">},</span> 
          <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;World Cup Champions&#39;</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022    Argentina
2018       France
2014      Germany
2010        Spain
2006        Italy
2002       Brazil
1998       France
1994       Brazil
1990      Germany
1986    Argentina
Name: World Cup Champions, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="pandas-dataframe">
<h3>Pandas DataFrame<a class="headerlink" href="#pandas-dataframe" title="Link to this heading">#</a></h3>
<p>While a Pandas Series is 1-dimensional with a single column/row of data, a Pandas DataFrame is 2-dimensional and can have multiple columns and rows.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Year</p></th>
<th class="head"><p>Champion</p></th>
<th class="head"><p>Host</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2022</p></td>
<td><p>Argentina</p></td>
<td><p>Qatar</p></td>
</tr>
<tr class="row-odd"><td><p>2018</p></td>
<td><p>France</p></td>
<td><p>Russia</p></td>
</tr>
<tr class="row-even"><td><p>2014</p></td>
<td><p>Germany</p></td>
<td><p>Brazil</p></td>
</tr>
<tr class="row-odd"><td><p>2010</p></td>
<td><p>Spain</p></td>
<td><p>South Africa</p></td>
</tr>
<tr class="row-even"><td><p>2006</p></td>
<td><p>Italy</p></td>
<td><p>Germany</p></td>
</tr>
<tr class="row-odd"><td><p>2002</p></td>
<td><p>Brazil</p></td>
<td><p>Korea/Japan</p></td>
</tr>
<tr class="row-even"><td><p>1998</p></td>
<td><p>France</p></td>
<td><p>France</p></td>
</tr>
<tr class="row-odd"><td><p>1994</p></td>
<td><p>Brazil</p></td>
<td><p>USA</p></td>
</tr>
<tr class="row-even"><td><p>1990</p></td>
<td><p>Germany</p></td>
<td><p>Italy</p></td>
</tr>
<tr class="row-odd"><td><p>1986</p></td>
<td><p>Argentina</p></td>
<td><p>Mexico</p></td>
</tr>
</tbody>
</table>
</div>
<p>Let’s create a Pandas DataFrame based on this table. To create our dataframe, we pass a <strong>dictionary</strong> into the <code class="docutils literal notranslate"><span class="pre">DataFrame()</span></code> method. Each <code class="docutils literal notranslate"><span class="pre">key:value</span></code> pair will form a column in the dataframe, with the key as the column name and the value as the data in that column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a Pandas dataframe</span>
<span class="n">wcup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2022</span><span class="p">,</span> 
                              <span class="mi">2018</span><span class="p">,</span> 
                              <span class="mi">2014</span><span class="p">,</span> 
                              <span class="mi">2010</span><span class="p">,</span> 
                              <span class="mi">2006</span><span class="p">,</span> 
                              <span class="mi">2002</span><span class="p">,</span> 
                              <span class="mi">1998</span><span class="p">,</span> 
                              <span class="mi">1994</span><span class="p">,</span> 
                              <span class="mi">1990</span><span class="p">,</span>
                              <span class="mi">1986</span><span class="p">],</span> 
                     <span class="s2">&quot;Champion&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Argentina&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Spain&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Italy&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
                                  <span class="s2">&quot;Argentina&quot;</span><span class="p">],</span> 
                     <span class="s2">&quot;Host&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Qatar&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Brazil&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;South Africa&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Korea/Japan&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;France&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;USA&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Italy&quot;</span><span class="p">,</span> 
                              <span class="s2">&quot;Mexico&quot;</span><span class="p">]</span>
                    <span class="p">})</span>

<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1998</td>
      <td>France</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1994</td>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990</td>
      <td>Germany</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986</td>
      <td>Argentina</td>
      <td>Mexico</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In a Pandas dataframe, each row/column is technically a Pandas Series. We can see this by selecting the first row with the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> method and check its type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the type of a row in a dataframe</span>
<span class="nb">type</span><span class="p">(</span><span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p>Let’s select a column and check its type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the type of a column in a dataframe</span>
<span class="nb">type</span><span class="p">(</span><span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Champion&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p>We will describe row/column selection in greater detail below.</p>
<h3 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h3>
<p>You are a middle school teacher. You teach the Butterfly Class and the Hippo Class. Last week, the Butterfly class had an English test and a math test. You would like to make a dataframe to record the English grades and math grades of the students in the Butterfly Class.</p>
<p>Make a dataframe with three columns: name, English and Math.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a dataframe</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="explore-the-data">
<h2>Explore the data<a class="headerlink" href="#explore-the-data" title="Link to this heading">#</a></h2>
<p>After we build a dataframe, it is helpful to get a general idea of the data. The first step is to explore the dataframe’s attributes. Attributes are properties of the dataframe (not functions), so they do not have parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code> after them.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Reveals</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.shape</p></td>
<td><p>The number of rows and columns</p></td>
</tr>
<tr class="row-odd"><td><p>.columns</p></td>
<td><p>The name of each column</p></td>
</tr>
</tbody>
</table>
</div>
<p>To get how many rows and columns a dataframe has, we use the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> attribute. <code class="docutils literal notranslate"><span class="pre">df.shape</span></code> returns a tuple with (number of rows, number of columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.shape returns a tuple (# of rows, # of columns)</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use `.columns` attribute to find the column names</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Year&#39;, &#39;Champion&#39;, &#39;Host&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>There are some methods we can use to explore the data as well.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Reveals</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.info( )</p></td>
<td><p>Column count and data type</p></td>
</tr>
<tr class="row-odd"><td><p>.head( )</p></td>
<td><p>First five rows</p></td>
</tr>
<tr class="row-even"><td><p>.tail( )</p></td>
<td><p>Last five rows</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use `.info()` to get column count and data type</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10 entries, 0 to 9
Data columns (total 3 columns):
 #   Column    Non-Null Count  Dtype 
---  ------    --------------  ----- 
 0   Year      10 non-null     int64 
 1   Champion  10 non-null     object
 2   Host      10 non-null     object
dtypes: int64(1), object(2)
memory usage: 372.0+ bytes
</pre></div>
</div>
</div>
</div>
<p>We can get a preview of the dataframe. The <code class="docutils literal notranslate"><span class="pre">.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">.tail()</span></code> methods help us do that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the first five rows of the data</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the last five rows of the data</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1998</td>
      <td>France</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1994</td>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990</td>
      <td>Germany</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986</td>
      <td>Argentina</td>
      <td>Mexico</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the number of rows at the beginning of the table to display</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1998</td>
      <td>France</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1994</td>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="read-and-write-tabular-data-in-pandas">
<h2>Read and write tabular data in Pandas<a class="headerlink" href="#read-and-write-tabular-data-in-pandas" title="Link to this heading">#</a></h2>
<p>Pandas provides different methods to read and write tabular data. The methods used to read in data from files are <code class="docutils literal notranslate"><span class="pre">.read_*()</span></code>. The methods used to write data into files are <code class="docutils literal notranslate"><span class="pre">.to_*()</span></code>.</p>
<p>For example, we can create a dataframe from a csv file using the <code class="docutils literal notranslate"><span class="pre">.read_csv()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Download the csv file</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>

<span class="c1"># Check if a data folder exists. If not, create it.</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/&#39;</span><span class="p">)</span>
<span class="n">data_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Download the file</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/Pandas1_failed_banks_since_2000.csv&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;../data/failed_banks_since_2000.csv&#39;</span><span class="p">)</span>

<span class="c1"># Download success message</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample file ready.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample file ready.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the read_csv() method to create a dataframe</span>
<span class="n">failed_banks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/failed_banks_since_2000.csv&#39;</span><span class="p">)</span>
<span class="n">failed_banks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bank Name</th>
      <th>City</th>
      <th>State</th>
      <th>Cert</th>
      <th>Acquiring Institution</th>
      <th>Closing Date</th>
      <th>Fund</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>First Republic Bank</td>
      <td>San Francisco</td>
      <td>CA</td>
      <td>59017</td>
      <td>JPMorgan Chase Bank, N.A.</td>
      <td>1-May-23</td>
      <td>10543</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Signature Bank</td>
      <td>New York</td>
      <td>NY</td>
      <td>57053</td>
      <td>Flagstar Bank, N.A.</td>
      <td>12-Mar-23</td>
      <td>10540</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Silicon Valley Bank</td>
      <td>Santa Clara</td>
      <td>CA</td>
      <td>24735</td>
      <td>First Citizens Bank &amp; Trust Company</td>
      <td>10-Mar-23</td>
      <td>10539</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Almena State Bank</td>
      <td>Almena</td>
      <td>KS</td>
      <td>15426</td>
      <td>Equity Bank</td>
      <td>23-Oct-20</td>
      <td>10538</td>
    </tr>
    <tr>
      <th>4</th>
      <td>First City Bank of Florida</td>
      <td>Fort Walton Beach</td>
      <td>FL</td>
      <td>16748</td>
      <td>United Fidelity Bank, fsb</td>
      <td>16-Oct-20</td>
      <td>10537</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>561</th>
      <td>Superior Bank, FSB</td>
      <td>Hinsdale</td>
      <td>IL</td>
      <td>32646</td>
      <td>Superior Federal, FSB</td>
      <td>27-Jul-01</td>
      <td>6004</td>
    </tr>
    <tr>
      <th>562</th>
      <td>Malta National Bank</td>
      <td>Malta</td>
      <td>OH</td>
      <td>6629</td>
      <td>North Valley Bank</td>
      <td>3-May-01</td>
      <td>4648</td>
    </tr>
    <tr>
      <th>563</th>
      <td>First Alliance Bank &amp; Trust Co.</td>
      <td>Manchester</td>
      <td>NH</td>
      <td>34264</td>
      <td>Southern New Hampshire Bank &amp; Trust</td>
      <td>2-Feb-01</td>
      <td>4647</td>
    </tr>
    <tr>
      <th>564</th>
      <td>National State Bank of Metropolis</td>
      <td>Metropolis</td>
      <td>IL</td>
      <td>3815</td>
      <td>Banterra Bank of Marion</td>
      <td>14-Dec-00</td>
      <td>4646</td>
    </tr>
    <tr>
      <th>565</th>
      <td>Bank of Honolulu</td>
      <td>Honolulu</td>
      <td>HI</td>
      <td>21029</td>
      <td>Bank of the Orient</td>
      <td>13-Oct-00</td>
      <td>4645</td>
    </tr>
  </tbody>
</table>
<p>566 rows × 7 columns</p>
</div></div></div>
</div>
<p>You can also write the tabular data from a dataframe into a file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write the dataframe we created for the world cup champions into a file</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/wcup_champions.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pandas can read data from files of many different formats and write data into files of many different formats.</p>
<center><img src="https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/Pandas1_DiffFormats.png" width="700"></center><p>Suppose you would like to read the data of COVID-19 cases in Massachusetts into a dataframe. Can you use a Pandas method to do that?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install openpyxl
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the excel file</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/Pandas1_covid_MA_06292023.xlsx&#39;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;../data/covid_MA.xlsx&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample file ready.&#39;</span><span class="p">)</span>

<span class="c1"># Read in the data</span>
<span class="n">covid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">covid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample file ready.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Positive Total</th>
      <th>Positive New</th>
      <th>Probable Total</th>
      <th>Probable New</th>
      <th>Estimated active cases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-06-01</td>
      <td>97291</td>
      <td>326</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-06-02</td>
      <td>97539</td>
      <td>248</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-03</td>
      <td>97964</td>
      <td>425</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-04</td>
      <td>98376</td>
      <td>412</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-05</td>
      <td>98796</td>
      <td>420</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>691</th>
      <td>2023-06-01</td>
      <td>2041048</td>
      <td>803</td>
      <td>204213.0</td>
      <td>325.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>692</th>
      <td>2023-06-08</td>
      <td>2041835</td>
      <td>787</td>
      <td>204574.0</td>
      <td>361.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>693</th>
      <td>2023-06-15</td>
      <td>2042644</td>
      <td>809</td>
      <td>204841.0</td>
      <td>267.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>694</th>
      <td>2023-06-22</td>
      <td>2043337</td>
      <td>693</td>
      <td>205138.0</td>
      <td>297.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>695</th>
      <td>2023-06-29</td>
      <td>2043979</td>
      <td>642</td>
      <td>205513.0</td>
      <td>375.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>696 rows × 6 columns</p>
</div></div></div>
</div>
<p>Now, can you write the dataframe you created into a json file?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write the dataframe into a json file</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-data">
<h2>Access data<a class="headerlink" href="#access-data" title="Link to this heading">#</a></h2>
<p>In this section, we will take a look at the different ways of accessing the data in a dataframe.</p>
<p>For example, once you get the column names, you could access a column of your interest. You can use the bracket notation <code class="docutils literal notranslate"><span class="pre">df[ColumnName]</span></code> to get a specific column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use bracket notation to access the column &#39;Champion&#39;</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Champion&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Argentina
1       France
2      Germany
3        Spain
4        Italy
5       Brazil
6       France
7       Brazil
8      Germany
9    Argentina
Name: Champion, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can also access multiple columns from a dataframe by putting the column names in a list. Note that in this case, you have two layers of hard brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple columns</span>
<span class="n">wcup</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Champion&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Argentina</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>France</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1998</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1994</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986</td>
      <td>Argentina</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="the-indexers-iloc-and-loc">
<h3>The indexers <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code><a class="headerlink" href="#the-indexers-iloc-and-loc" title="Link to this heading">#</a></h3>
<p>In Pandas, there are two indexers <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code> that are often used to access data in a dataframe.</p>
<section id="iloc">
<h4>.iloc<a class="headerlink" href="#iloc" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code> allows us to access a row or a column using its <em>integer location</em>.</p>
<p>Recall that in a dataframe, by default, to the left of each row are index numbers. The index numbers are similar to the index numbers for a Python list; they help us reference a particular row for data retrieval. Also, like a Python list, the index begins with 0.</p>
<p>We can retrieve data using the <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> attribute. The syntax of <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> indexer is <code class="docutils literal notranslate"><span class="pre">df.iloc[row</span> <span class="pre">selection,</span> <span class="pre">column</span> <span class="pre">selection]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a single row</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># Access the row with the index number 5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year               2002
Champion         Brazil
Host        Korea/Japan
Name: 5, dtype: object
</pre></div>
</div>
</div>
</div>
<p>When we select multiple consecutive rows from a dataframe, we give a starting index and an ending index. Notice that the selected rows will <strong>not</strong> include the final index row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple consecutive rows</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># Access the rows with the index number 2, 3, and 4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple non-consecutive rows</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="c1"># Access the rows with the index number 0, 2, and 5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># access every other row in wcup</span>
</pre></div>
</div>
</div>
</div>
<p>We have seen how we can access rows from a dataframe using the <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> indexer. In the following, we will use the <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> indexer to access columns. Recall that the syntax of <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> indexer is <code class="docutils literal notranslate"><span class="pre">df.iloc[row</span> <span class="pre">selection,</span> <span class="pre">column</span> <span class="pre">selection]</span></code>. Again, the index numbers for the columns are similar to the index numbers for a Python list; they help us reference a particular column for data retrieval. Also, like a Python list, the index begins with 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a single column</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Access the column with the index number 1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Argentina
1       France
2      Germany
3        Spain
4        Italy
5       Brazil
6       France
7       Brazil
8      Germany
9    Argentina
Name: Champion, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Note that we cannot use the column name, i.e., the header, to access a column because <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> accesses data using their <em>integer location</em>. If we try to access a column using its column name, we get an error!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># .iloc cannot access a column by its name</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="s1">&#39;Champion&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/indexing.py:966,</span> in <span class="ni">_LocationIndexer._validate_tuple_indexer</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">965</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">966</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_validate_key</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/indexing.py:1614,</span> in <span class="ni">_iLocIndexer._validate_key</span><span class="nt">(self, key, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">1613</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1614</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can only index by location with a [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_valid_types</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: Can only index by location with a [integer, integer slice (START point is INCLUDED, END point is EXCLUDED), listlike of integers, boolean array]

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># .iloc cannot access a column by its name</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="s1">&#39;Champion&#39;</span><span class="p">]</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/indexing.py:1184,</span> in <span class="ni">_LocationIndexer.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1182</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scalar_access</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1183</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">takeable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_takeable</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1184</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_tuple</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1185</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1186</span>     <span class="c1"># we by definition only have the 0th axis</span>
<span class="g g-Whitespace">   </span><span class="mi">1187</span>     <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="ow">or</span> <span class="mi">0</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/indexing.py:1690,</span> in <span class="ni">_iLocIndexer._getitem_tuple</span><span class="nt">(self, tup)</span>
<span class="g g-Whitespace">   </span><span class="mi">1689</span> <span class="k">def</span><span class="w"> </span><span class="nf">_getitem_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tup</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1690</span>     <span class="n">tup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_tuple_indexer</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1691</span>     <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="n">IndexingError</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1692</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_lowerdim</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/indexing.py:968,</span> in <span class="ni">_LocationIndexer._validate_tuple_indexer</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">966</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_validate_key</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>     <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">968</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">969</span>             <span class="s2">&quot;Location based indexing can only have &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span>             <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_valid_types</span><span class="si">}</span><span class="s2">] types&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span>         <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">972</span> <span class="k">return</span> <span class="n">key</span>

<span class="ne">ValueError</span>: Location based indexing can only have [integer, integer slice (START point is INCLUDED, END point is EXCLUDED), listlike of integers, boolean array] types
</pre></div>
</div>
</div>
</div>
<p>We can use integer slice to access multiple columns from a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple consecutive columns </span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># Access the second and third column of the dataframe wcup </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>France</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Germany</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Argentina</td>
      <td>Mexico</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple non-consecutive columns</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># Access the first and third column of the dataframe wcup </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Host</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2002</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1998</td>
      <td>France</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1994</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1990</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986</td>
      <td>Mexico</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that you know how to select rows and columns from a dataframe using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>. You should be able to figure out how to get a slice of a dataframe using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>. For example, if you would like to know the champion of the world cup games between 1994 and 2010. How do you slice the dataframe <code class="docutils literal notranslate"><span class="pre">wcup</span></code> to get the part you are interested in?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slice the dataframe using .iloc[ ]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="loc">
<h4>.loc<a class="headerlink" href="#loc" title="Link to this heading">#</a></h4>
<p>While <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> is integer-based, <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is label-based. It means that you have to access rows and columns based on their row and column labels.</p>
<p>The syntax of <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is <code class="docutils literal notranslate"><span class="pre">df.loc[row</span> <span class="pre">selection,</span> <span class="pre">column</span> <span class="pre">selection]</span></code>.</p>
<p>At the moment, the labels for the rows are just their index numbers. When we use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to access a row, it will look very similar to what we did with <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a row using .loc</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year             2022
Champion    Argentina
Host            Qatar
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>But we could make our index column customized. For example, we could use the column <code class="docutils literal notranslate"><span class="pre">Year</span></code> as the index column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the column &#39;Year&#39; as the index column</span>
<span class="n">wcup</span> <span class="o">=</span> <span class="n">wcup</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022</th>
      <td>Argentina</td>
      <td>Qatar</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>Italy</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>France</td>
      <td>France</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>Germany</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>Argentina</td>
      <td>Mexico</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>After we make the change, we will use the new labels to access the rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a row using .loc</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2006</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Champion      Italy
Host        Germany
Name: 2006, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple consecutive rows</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2018</span><span class="p">:</span><span class="mi">2010</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that with the label search, the ending index row is included.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access multiple non-consecutive rows</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1994</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2010</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access a column</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Host&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year
2022           Qatar
2018          Russia
2014          Brazil
2010    South Africa
2006         Germany
2002     Korea/Japan
1998          France
1994             USA
1990           Italy
1986          Mexico
Name: Host, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now that you know how to select rows and columns from a dataframe using <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code>. You should be able to figure out how to get a slice of a dataframe using <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code>. For example, if you would like to know the champion of the world cup games between 1994 and 2010. How do you slice the dataframe <code class="docutils literal notranslate"><span class="pre">wcup</span></code> to get the part you are interested in?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slice the dataframe using .loc[ ]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>As a quick reminder</strong>, remember that <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> slicing is not inclusive of the final value. On the other hand, <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> slicing does include the final value.</p>
</section>
</section>
<section id="the-indexers-iat-and-at">
<h3>The indexers <code class="docutils literal notranslate"><span class="pre">.iat</span></code> and <code class="docutils literal notranslate"><span class="pre">.at</span></code><a class="headerlink" href="#the-indexers-iat-and-at" title="Link to this heading">#</a></h3>
<p>We have learned how to use the two indexers <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to access rows and columns from a dataframe. In real life, sometimes we only want to access the value in a single cell. In this case, the fastest way is to use the <code class="docutils literal notranslate"><span class="pre">.iat</span></code> and <code class="docutils literal notranslate"><span class="pre">at</span></code> indexers. We can now tell from the name that <code class="docutils literal notranslate"><span class="pre">iat</span></code> provides <strong>integer</strong>-based lookups while <code class="docutils literal notranslate"><span class="pre">at</span></code> provides <strong>label</strong>-based lookups.</p>
<p>Suppose we would like to get the champion country of the 2002 world cup. How do you do that?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the champion country of the 2002 world cup using .at[]</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="s1">&#39;Champion&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Brazil&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the champion country of the 2002 world cup using .iat[]</span>
<span class="n">wcup</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Brazil&#39;
</pre></div>
</div>
</div>
</div>
<h3 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h3>
<p>You are a middle school teacher. You have a .csv file that stores the English grades and Math grades of the students in your Butterfly class. Can you use a <code class="docutils literal notranslate"><span class="pre">.read_*()</span></code> method to read in the data from the file and create a dataframe? After that, can you use <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> or <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> to get the Math grades of the first three students from the dataframe?
After you get the slice of the dataframe with the Math grades of the first three students, can you write the data into a file of <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> format?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the csv file</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/Pandas1_grades.csv&#39;</span>
<span class="n">grades_file</span> <span class="o">=</span> <span class="s1">&#39;../data/Grades.csv&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">grades_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample file ready.&#39;</span><span class="p">)</span>

<span class="c1"># Read in the data and create a dataframe</span>


<span class="c1"># Select the Math grades for the first three students</span>


<span class="c1"># Write the slice into a file of .xlsx format</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample file ready.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="set-values">
<h2>Set values<a class="headerlink" href="#set-values" title="Link to this heading">#</a></h2>
<p>Now that we know how to access data from a dataframe, we could easily use what we have learned to set the values in a dataframe. To do that, we will use assignment statements you have learned in Python Basics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the data</span>
<span class="n">grades</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Grades.csv&#39;</span><span class="p">)</span>
<span class="n">grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>English</th>
      <th>Math</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>78</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alex Hazel</td>
      <td>80</td>
      <td>75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Beatrice Dean</td>
      <td>72</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jane White</td>
      <td>75</td>
      <td>70</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eve Lynn</td>
      <td>73</td>
      <td>82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="use-the-indexers-to-set-values">
<h3>Use the indexers to set values<a class="headerlink" href="#use-the-indexers-to-set-values" title="Link to this heading">#</a></h3>
<p>Recall that we have learned how to use the indexers to access a slice of a dataframe. We can use the same indexers to change the values in a dataframe.</p>
<p>For example, we can get the English grades in the first two rows and change the values to 80.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the English grades in the first two rows and change to 80</span>
<span class="n">grades</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
<p>Can you use <code class="docutils literal notranslate"><span class="pre">loc</span></code> to change the math grades in the last two rows to 90?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change the math grades in the last two rows to 90</span>
</pre></div>
</div>
</div>
</div>
<p>And of course, we can get a single value from a dataframe and change it using <code class="docutils literal notranslate"><span class="pre">iat</span></code> or <code class="docutils literal notranslate"><span class="pre">at</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Jane White&#39;s math grade and change it to 85</span>
<span class="n">grades</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">85</span>
</pre></div>
</div>
</div>
</div>
<p>It’s your turn. Can you get Eve Lynn’s English grade and change it to 82? This time, however, use <code class="docutils literal notranslate"><span class="pre">iat</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Eve Lynn&#39;s math grade and change it to 85</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-new-column-based-on-an-existing-one">
<h3>Create a new column based on an existing one<a class="headerlink" href="#create-a-new-column-based-on-an-existing-one" title="Link to this heading">#</a></h3>
<p>Let’s get the world cup dataframe again. We add a new column Score to store the scores of the games. Can you set the values in this column to the goals that were scored by the champion in the games?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a new column of score</span>
<span class="n">score</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;7-5&quot;</span><span class="p">,</span> <span class="c1">### put the data in a list</span>
         <span class="s2">&quot;4-2&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;1-0&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;1-0&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;6-4&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;2-0&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;3-0&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;3-2&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;1-0&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;3-2&quot;</span><span class="p">]</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span> <span class="c1"># make a new column of score</span>
<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
      <th>Score</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022</th>
      <td>Argentina</td>
      <td>Qatar</td>
      <td>7-5</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
      <td>4-2</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
      <td>1-0</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
      <td>1-0</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>Italy</td>
      <td>Germany</td>
      <td>6-4</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
      <td>2-0</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>France</td>
      <td>France</td>
      <td>3-0</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
      <td>3-2</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>Germany</td>
      <td>Italy</td>
      <td>1-0</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>Argentina</td>
      <td>Mexico</td>
      <td>3-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In soccer games, it is common to calculate the goals scored and goals conceded by the champion in the final.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a new column &#39;Goals Scored&#39;</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Scored&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
      <th>Score</th>
      <th>Goals Scored</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022</th>
      <td>Argentina</td>
      <td>Qatar</td>
      <td>7-5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
      <td>4-2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
      <td>1-0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
      <td>1-0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>Italy</td>
      <td>Germany</td>
      <td>6-4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
      <td>2-0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>France</td>
      <td>France</td>
      <td>3-0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
      <td>3-2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>Germany</td>
      <td>Italy</td>
      <td>1-0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>Argentina</td>
      <td>Mexico</td>
      <td>3-2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a new column &#39;Goals Conceded&#39;</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Conceded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
      <th>Score</th>
      <th>Goals Scored</th>
      <th>Goals Conceded</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022</th>
      <td>Argentina</td>
      <td>Qatar</td>
      <td>7-5</td>
      <td>7</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
      <td>4-2</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>Italy</td>
      <td>Germany</td>
      <td>6-4</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
      <td>2-0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>France</td>
      <td>France</td>
      <td>3-0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
      <td>3-2</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>Germany</td>
      <td>Italy</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>Argentina</td>
      <td>Mexico</td>
      <td>3-2</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With the info on goals scored and conceded by the champion, we can create a column containing the difference between the two.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column &#39;Difference&#39;</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Scored&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Conceded&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/ops/array_ops.py:218,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">218</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/computation/expressions.py:242,</span> in <span class="ni">evaluate</span><span class="nt">(op, a, b, use_numexpr)</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>     <span class="k">if</span> <span class="n">use_numexpr</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">241</span>         <span class="c1"># error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">242</span>         <span class="k">return</span> <span class="n">_evaluate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span> <span class="k">return</span> <span class="n">_evaluate_standard</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/computation/expressions.py:73,</span> in <span class="ni">_evaluate_standard</span><span class="nt">(op, op_str, a, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>     <span class="n">_store_test_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">73</span> <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">51</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Create a new column &#39;Difference&#39;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Scored&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Conceded&#39;</span><span class="p">]</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/ops/common.py:76,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">76</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/arraylike.py:194,</span> in <span class="ni">OpsMixin.__sub__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__sub__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">193</span> <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">194</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/series.py:6146,</span> in <span class="ni">Series._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">6144</span> <span class="k">def</span><span class="w"> </span><span class="nf">_arith_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">6145</span>     <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align_for_op</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">6146</span>     <span class="k">return</span> <span class="n">base</span><span class="o">.</span><span class="n">IndexOpsMixin</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/base.py:1391,</span> in <span class="ni">IndexOpsMixin._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">1388</span>     <span class="n">rvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rvalues</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">rvalues</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">rvalues</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1390</span> <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1391</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">arithmetic_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1393</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/ops/array_ops.py:283,</span> in <span class="ni">arithmetic_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span>     <span class="n">_bool_arith_check</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span>     <span class="c1"># error: Argument 1 to &quot;_na_arithmetic_op&quot; has incompatible type</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span>     <span class="c1"># &quot;Union[ExtensionArray, ndarray[Any, Any]]&quot;; expected &quot;ndarray[Any, Any]&quot;</span>
<span class="ne">--&gt; </span><span class="mi">283</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">_na_arithmetic_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">285</span> <span class="k">return</span> <span class="n">res_values</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/ops/array_ops.py:227,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cmp</span> <span class="ow">and</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="n">left</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">object</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="nb">object</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="p">):</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">225</span>         <span class="c1"># Don&#39;t do this for comparisons, as that will handle complex numbers</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>         <span class="c1">#  incorrectly, see GH#32047</span>
<span class="ne">--&gt; </span><span class="mi">227</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_masked_arith_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>         <span class="k">raise</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/core/ops/array_ops.py:163,</span> in <span class="ni">_masked_arith_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="c1"># See GH#5284, GH#5035, GH#19448 for historical reference</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>     <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">163</span>         <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">xrav</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">yrav</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>We get an error! Why? The error message gives us a hint. The minus operator is not defined for the data type str!</p>
<p>Luckily, Pandas has a convenient method that allows us to convert data types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column &#39;Difference&#39;</span>
<span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Scored&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span>  <span class="n">wcup</span><span class="p">[</span><span class="s1">&#39;Goals Conceded&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">wcup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Champion</th>
      <th>Host</th>
      <th>Score</th>
      <th>Goals Scored</th>
      <th>Goals Conceded</th>
      <th>Difference</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022</th>
      <td>Argentina</td>
      <td>Qatar</td>
      <td>7-5</td>
      <td>7</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>France</td>
      <td>Russia</td>
      <td>4-2</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>Germany</td>
      <td>Brazil</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>Spain</td>
      <td>South Africa</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>Italy</td>
      <td>Germany</td>
      <td>6-4</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>Brazil</td>
      <td>Korea/Japan</td>
      <td>2-0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>France</td>
      <td>France</td>
      <td>3-0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>Brazil</td>
      <td>USA</td>
      <td>3-2</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>Germany</td>
      <td>Italy</td>
      <td>1-0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1986</th>
      <td>Argentina</td>
      <td>Mexico</td>
      <td>3-2</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<h3 style="color:red; display:inline">Coding Challenge! &lt; / &gt; </h3>
<p>Can you create two new columns in the grades dataframe, one with the students’ first names, one with their last names?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take a look at the grades df</span>
<span class="n">grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>English</th>
      <th>Math</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>80</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alex Hazel</td>
      <td>80</td>
      <td>75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Beatrice Dean</td>
      <td>72</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jane White</td>
      <td>75</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eve Lynn</td>
      <td>73</td>
      <td>82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="lesson-complete">
<h2>Lesson Complete<a class="headerlink" href="#lesson-complete" title="Link to this heading">#</a></h2>
<p>Congratulations! You have completed <em>Pandas Basics 1</em>.</p>
<section id="start-next-lesson-pandas-2">
<h3>Start Next Lesson: <a class="reference internal" href="pandas-2.html"><span class="std std-doc">Pandas 2 -&gt;</span></a><a class="headerlink" href="#start-next-lesson-pandas-2" title="Link to this heading">#</a></h3>
</section>
<section id="exercise-solutions">
<h3>Exercise Solutions<a class="headerlink" href="#exercise-solutions" title="Link to this heading">#</a></h3>
<p>Here are a few solutions for exercises in this lesson.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a dataframe to record English and Math grades of the Butterfly class</span>
<span class="n">butterfly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;John Smith&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Alex Hazel&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Beatrice Dean&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Jane White&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Eve Lynn&#39;</span><span class="p">],</span>                        
                         <span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">78</span><span class="p">,</span>
                                    <span class="mi">80</span><span class="p">,</span>
                                    <span class="mi">72</span><span class="p">,</span>
                                    <span class="mi">75</span><span class="p">,</span>
                                    <span class="mi">73</span><span class="p">],</span>
                         <span class="s2">&quot;Math&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span>
                                 <span class="mi">75</span><span class="p">,</span>
                                 <span class="mi">95</span><span class="p">,</span>
                                 <span class="mi">70</span><span class="p">,</span>
                                 <span class="mi">82</span><span class="p">]</span>
                         <span class="p">})</span>
<span class="n">butterfly</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>English</th>
      <th>Math</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>78</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alex Hazel</td>
      <td>80</td>
      <td>75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Beatrice Dean</td>
      <td>72</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jane White</td>
      <td>75</td>
      <td>70</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eve Lynn</td>
      <td>73</td>
      <td>82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Get the math grades of the first three students and write the data into an excel file</span>

<span class="c1"># Download the csv file</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ithaka-labs.s3.amazonaws.com/static-files/images/tdm/tdmdocs/Pandas1_grades.csv&#39;</span>
<span class="n">grades_file</span> <span class="o">=</span> <span class="s1">&#39;../data/Grades.csv&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">grades_file</span><span class="p">)</span>

<span class="c1"># Read in the data and create a dataframe</span>
<span class="n">butterfly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">grades_file</span><span class="p">)</span>

<span class="c1"># Select the Math grades for the first three students</span>
<span class="n">butterfly_slice</span> <span class="o">=</span> <span class="n">butterfly</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Math&#39;</span><span class="p">]]</span>

<span class="c1"># Write the slice into a file of .xlsx format</span>
<span class="n">butterfly_slice</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;../data/butterfly_slice.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can you create two new columns in the grades dataframe </span>
<span class="c1"># one with the students&#39; first names, one with their last names</span>
<span class="n">grades</span><span class="p">[</span><span class="s1">&#39;First Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grades</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">grades</span><span class="p">[</span><span class="s1">&#39;Last Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grades</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">grades</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>English</th>
      <th>Math</th>
      <th>First Name</th>
      <th>Last Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>80</td>
      <td>80</td>
      <td>John</td>
      <td>Smith</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alex Hazel</td>
      <td>80</td>
      <td>75</td>
      <td>Alex</td>
      <td>Hazel</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Beatrice Dean</td>
      <td>72</td>
      <td>95</td>
      <td>Beatrice</td>
      <td>Dean</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jane White</td>
      <td>75</td>
      <td>85</td>
      <td>Jane</td>
      <td>White</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eve Lynn</td>
      <td>73</td>
      <td>82</td>
      <td>Eve</td>
      <td>Lynn</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./src/PythonForDataAnalysis/GettingStarted/pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series-and-pandas-dataframe">Pandas Series and Pandas DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series">Pandas Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe">Pandas DataFrame</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-data">Explore the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-write-tabular-data-in-pandas">Read and write tabular data in Pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data">Access data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-indexers-iloc-and-loc">The indexers <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iloc">.iloc</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loc">.loc</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-indexers-iat-and-at">The indexers <code class="docutils literal notranslate"><span class="pre">.iat</span></code> and <code class="docutils literal notranslate"><span class="pre">.at</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-values">Set values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-indexers-to-set-values">Use the indexers to set values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-column-based-on-an-existing-one">Create a new column based on an existing one</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-complete">Lesson Complete</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#start-next-lesson-pandas-2">Start Next Lesson: <span class="xref myst">Pandas 2 -&gt;</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-solutions">Exercise Solutions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By University of South Carolina Libraries
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>